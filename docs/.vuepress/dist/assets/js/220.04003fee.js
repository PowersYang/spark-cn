(window.webpackJsonp=window.webpackJsonp||[]).push([[220],{420:function(e,t,a){"use strict";a.r(t);var o=a(0),r=Object(o.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"hdfs-short-circuit-local-reads"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hdfs-short-circuit-local-reads"}},[e._v("#")]),e._v(" HDFS Short-Circuit Local Reads")]),e._v(" "),a("h2",{attrs:{id:"short-circuit-local-reads"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#short-circuit-local-reads"}},[e._v("#")]),e._v(" Short-Circuit Local Reads")]),e._v(" "),a("h3",{attrs:{id:"background"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#background"}},[e._v("#")]),e._v(" Background")]),e._v(" "),a("p",[e._v("In HDFS, reads normally go through the DataNode. Thus, when the client asks the DataNode to read a file, the DataNode reads that file off of the disk and sends the data to the client over a TCP socket. So-called “short-circuit” reads bypass the DataNode, allowing the client to read the file directly. Obviously, this is only possible in cases where the client is co-located with the data. Short-circuit reads provide a substantial performance boost to many applications.")]),e._v(" "),a("h3",{attrs:{id:"setup"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#setup"}},[e._v("#")]),e._v(" Setup")]),e._v(" "),a("p",[e._v("To configure short-circuit local reads, you will need to enable libhadoop.so. See "),a("router-link",{attrs:{to:"/en/docs/hadoop-project-dist/hadoop-common/NativeLibraries.html"}},[e._v("Native Libraries")]),e._v(" for details on enabling this library.")],1),e._v(" "),a("p",[e._v("Short-circuit reads make use of a UNIX domain socket. This is a special path in the filesystem that allows the client and the DataNodes to communicate. You will need to set a path to this socket. The DataNode needs to be able to create this path. On the other hand, it should not be possible for any user except the HDFS user or root to create this path. For this reason, paths under /var/run or /var/lib are often used.")]),e._v(" "),a("p",[e._v("The client and the DataNode exchange information via a shared memory segment on /dev/shm.")]),e._v(" "),a("p",[e._v("Short-circuit local reads need to be configured on both the DataNode and the client.")]),e._v(" "),a("h3",{attrs:{id:"example-configuration"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#example-configuration"}},[e._v("#")]),e._v(" Example Configuration")]),e._v(" "),a("p",[e._v("Here is an example configuration.")]),e._v(" "),a("pre",[a("code",[e._v("<configuration>\n  <property>\n    <name>dfs.client.read.shortcircuit</name>\n    <value>true</value>\n  </property>\n  <property>\n    <name>dfs.domain.socket.path</name>\n    <value>/var/lib/hadoop-hdfs/dn_socket</value>\n  </property>\n</configuration>\n")])]),e._v(" "),a("h2",{attrs:{id:"legacy-hdfs-short-circuit-local-reads"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#legacy-hdfs-short-circuit-local-reads"}},[e._v("#")]),e._v(" Legacy HDFS Short-Circuit Local Reads")]),e._v(" "),a("p",[e._v("Legacy implementation of short-circuit local reads on which the clients directly open the HDFS block files is still available for platforms other than the Linux. Setting the value of dfs.client.use.legacy.blockreader.local in addition to dfs.client.read.shortcircuit to true enables this feature.")]),e._v(" "),a("p",[e._v("You also need to set the value of dfs.datanode.data.dir.perm to 750 instead of the default 700 and chmod/chown the directory tree under dfs.datanode.data.dir as readable to the client and the DataNode. You must take caution because this means that the client can read all of the block files bypassing HDFS permission.")]),e._v(" "),a("p",[e._v("Because Legacy short-circuit local reads is insecure, access to this feature is limited to the users listed in the value of dfs.block.local-path-access.user.")]),e._v(" "),a("pre",[a("code",[e._v("<configuration>\n  <property>\n    <name>dfs.client.read.shortcircuit</name>\n    <value>true</value>\n  </property>\n  <property>\n    <name>dfs.client.use.legacy.blockreader.local</name>\n    <value>true</value>\n  </property>\n  <property>\n    <name>dfs.datanode.data.dir.perm</name>\n    <value>750</value>\n  </property>\n  <property>\n    <name>dfs.block.local-path-access.user</name>\n    <value>foo,bar</value>\n  </property>\n</configuration>\n")])])])}),[],!1,null,null,null);t.default=r.exports}}]);